<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Categorical Variables | Structural Equation Modeling in R for Ecology and Evolution</title>
  <meta name="description" content="5 Categorical Variables | Structural Equation Modeling in R for Ecology and Evolution" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Categorical Variables | Structural Equation Modeling in R for Ecology and Evolution" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="jslefche/sem_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Categorical Variables | Structural Equation Modeling in R for Ecology and Evolution" />
  
  
  

<meta name="author" content="Jonathan Lefcheck" />


<meta name="date" content="2021-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="coefficients.html"/>
<link rel="next" href="multigroup-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="global-estimation.html"><a href="global-estimation.html"><i class="fa fa-check"></i><b>2</b> Global Estimation</a><ul>
<li class="chapter" data-level="2.1" data-path="global-estimation.html"><a href="global-estimation.html#what-is-covariance"><i class="fa fa-check"></i><b>2.1</b> What is (Co)variance?</a></li>
<li class="chapter" data-level="2.2" data-path="global-estimation.html"><a href="global-estimation.html#regression-coefficients"><i class="fa fa-check"></i><b>2.2</b> Regression Coefficients</a><ul>
<li class="chapter" data-level="2.2.1" data-path="global-estimation.html"><a href="global-estimation.html#rule-1-unspecified-relationships-among-exogenous-variables-are-simply-their-bivariate-correlations."><i class="fa fa-check"></i><b>2.2.1</b> Rule 1: Unspecified relationships among exogenous variables are simply their bivariate correlations.</a></li>
<li class="chapter" data-level="2.2.2" data-path="global-estimation.html"><a href="global-estimation.html#rule-2-when-two-variables-are-connected-by-a-single-path-the-coefficient-of-that-path-is-the-regression-coefficient."><i class="fa fa-check"></i><b>2.2.2</b> Rule 2: When two variables are connected by a single path, the coefficient of that path is the regression coefficient.</a></li>
<li class="chapter" data-level="2.2.3" data-path="global-estimation.html"><a href="global-estimation.html#rule-3-the-strength-of-a-compound-path-one-that-includes-multiple-links-is-the-product-of-the-individual-coefficients."><i class="fa fa-check"></i><b>2.2.3</b> Rule 3: The strength of a compound path (one that includes multiple links) is the product of the individual coefficients.</a></li>
<li class="chapter" data-level="2.2.4" data-path="global-estimation.html"><a href="global-estimation.html#rule-4.-when-variables-are-connected-by-more-than-one-pathway-each-pathway-is-the-partial-regression-coefficient."><i class="fa fa-check"></i><b>2.2.4</b> Rule 4. When variables are connected by more than one pathway, each pathway is the ‘partial’ regression coefficient.</a></li>
<li class="chapter" data-level="2.2.5" data-path="global-estimation.html"><a href="global-estimation.html#rule-5-errors-on-endogenous-variables-relate-the-unexplained-correlations-or-variances-arising-from-unmeasured-variables."><i class="fa fa-check"></i><b>2.2.5</b> Rule 5: Errors on endogenous variables relate the unexplained correlations or variances arising from unmeasured variables.</a></li>
<li class="chapter" data-level="2.2.6" data-path="global-estimation.html"><a href="global-estimation.html#rule-6-unanalyzed-residual-correlations-among-two-endogenous-variables-are-their-partial-correlations."><i class="fa fa-check"></i><b>2.2.6</b> Rule 6: Unanalyzed (residual) correlations among two endogenous variables are their partial correlations.</a></li>
<li class="chapter" data-level="2.2.7" data-path="global-estimation.html"><a href="global-estimation.html#rule-7-the-total-effect-one-variable-has-another-is-the-sum-of-its-direct-and-indirect-effects."><i class="fa fa-check"></i><b>2.2.7</b> Rule 7: The total effect one variable has another is the sum of its direct and indirect effects.</a></li>
<li class="chapter" data-level="2.2.8" data-path="global-estimation.html"><a href="global-estimation.html#rule-8-the-total-effect-including-undirected-paths-is-equivalent-to-the-total-correlation."><i class="fa fa-check"></i><b>2.2.8</b> Rule 8: The total effect (including undirected paths) is equivalent to the total correlation.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="global-estimation.html"><a href="global-estimation.html#variance-based-structural-equation-modeling"><i class="fa fa-check"></i><b>2.3</b> Variance-based Structural Equation Modeling</a></li>
<li class="chapter" data-level="2.4" data-path="global-estimation.html"><a href="global-estimation.html#model-identifiability"><i class="fa fa-check"></i><b>2.4</b> Model Identifiability</a></li>
<li class="chapter" data-level="2.5" data-path="global-estimation.html"><a href="global-estimation.html#goodness-of-fit-measures"><i class="fa fa-check"></i><b>2.5</b> Goodness-of-fit Measures</a></li>
<li class="chapter" data-level="2.6" data-path="global-estimation.html"><a href="global-estimation.html#model-fitting-using-lavaan"><i class="fa fa-check"></i><b>2.6</b> Model Fitting Using <em>lavaan</em></a><ul>
<li class="chapter" data-level="2.6.1" data-path="global-estimation.html"><a href="global-estimation.html#lavaan-vs-lm"><i class="fa fa-check"></i><b>2.6.1</b> <em>lavaan</em> vs <code>lm</code></a></li>
<li class="chapter" data-level="2.6.2" data-path="global-estimation.html"><a href="global-estimation.html#sem-using-lavaan"><i class="fa fa-check"></i><b>2.6.2</b> SEM using <em>lavaan</em></a></li>
<li class="chapter" data-level="2.6.3" data-path="global-estimation.html"><a href="global-estimation.html#testing-alternative-structures-using-lavaan"><i class="fa fa-check"></i><b>2.6.3</b> Testing Alternative Structures using <em>lavaan</em></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="global-estimation.html"><a href="global-estimation.html#references"><i class="fa fa-check"></i><b>2.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="local-estimation.html"><a href="local-estimation.html"><i class="fa fa-check"></i><b>3</b> Local Estimation</a><ul>
<li class="chapter" data-level="3.1" data-path="local-estimation.html"><a href="local-estimation.html#global-vs.-local-estimation"><i class="fa fa-check"></i><b>3.1</b> Global vs. local estimation</a></li>
<li class="chapter" data-level="3.2" data-path="local-estimation.html"><a href="local-estimation.html#tests-of-directed-separation"><i class="fa fa-check"></i><b>3.2</b> Tests of directed separation</a></li>
<li class="chapter" data-level="3.3" data-path="local-estimation.html"><a href="local-estimation.html#a-log-likelihood-approach-to-assessing-model-fit"><i class="fa fa-check"></i><b>3.3</b> A Log-Likelihood Approach to Assessing Model Fit</a></li>
<li class="chapter" data-level="3.4" data-path="local-estimation.html"><a href="local-estimation.html#model-fitting-using-piecewisesem"><i class="fa fa-check"></i><b>3.4</b> Model fitting using <em>piecewiseSEM</em></a></li>
<li class="chapter" data-level="3.5" data-path="local-estimation.html"><a href="local-estimation.html#extensions-to-generalized-mixed-effects-models"><i class="fa fa-check"></i><b>3.5</b> Extensions to Generalized Mixed Effects Models</a></li>
<li class="chapter" data-level="3.6" data-path="local-estimation.html"><a href="local-estimation.html#extensions-to-non-linear-models"><i class="fa fa-check"></i><b>3.6</b> Extensions to Non-linear Models</a></li>
<li class="chapter" data-level="3.7" data-path="local-estimation.html"><a href="local-estimation.html#a-special-case-where-graph-theory-fails"><i class="fa fa-check"></i><b>3.7</b> A Special Case: Where Graph Theory Fails</a></li>
<li class="chapter" data-level="3.8" data-path="local-estimation.html"><a href="local-estimation.html#references-1"><i class="fa fa-check"></i><b>3.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="coefficients.html"><a href="coefficients.html"><i class="fa fa-check"></i><b>4</b> Coefficients</a><ul>
<li class="chapter" data-level="4.1" data-path="coefficients.html"><a href="coefficients.html#unstandardized-and-standardized-coefficients"><i class="fa fa-check"></i><b>4.1</b> Unstandardized and Standardized Coefficients</a></li>
<li class="chapter" data-level="4.2" data-path="coefficients.html"><a href="coefficients.html#scale-standardization"><i class="fa fa-check"></i><b>4.2</b> Scale Standardization</a></li>
<li class="chapter" data-level="4.3" data-path="coefficients.html"><a href="coefficients.html#range-standardization"><i class="fa fa-check"></i><b>4.3</b> Range Standardization</a></li>
<li class="chapter" data-level="4.4" data-path="coefficients.html"><a href="coefficients.html#binomial-response-models"><i class="fa fa-check"></i><b>4.4</b> Binomial Response Models</a><ul>
<li class="chapter" data-level="4.4.1" data-path="coefficients.html"><a href="coefficients.html#latent-theoretic-approach"><i class="fa fa-check"></i><b>4.4.1</b> Latent Theoretic Approach</a></li>
<li class="chapter" data-level="4.4.2" data-path="coefficients.html"><a href="coefficients.html#observation-empirical-approach"><i class="fa fa-check"></i><b>4.4.2</b> Observation-Empirical Approach</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="coefficients.html"><a href="coefficients.html#scaling-to-other-non-normal-distributions"><i class="fa fa-check"></i><b>4.5</b> Scaling to Other Non-Normal Distributions</a></li>
<li class="chapter" data-level="4.6" data-path="coefficients.html"><a href="coefficients.html#references-2"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>5</b> Categorical Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="categorical-variables.html"><a href="categorical-variables.html#introduction-to-exogenous-categorical-variables"><i class="fa fa-check"></i><b>5.1</b> Introduction to Exogenous Categorical Variables</a></li>
<li class="chapter" data-level="5.2" data-path="categorical-variables.html"><a href="categorical-variables.html#exogenous-categorical-variables-as-marginal-means"><i class="fa fa-check"></i><b>5.2</b> Exogenous Categorical Variables as Marginal Means</a></li>
<li class="chapter" data-level="5.3" data-path="categorical-variables.html"><a href="categorical-variables.html#exogenous-categorical-variables-as-marginal-means-a-worked-example"><i class="fa fa-check"></i><b>5.3</b> Exogenous Categorical Variables as Marginal Means: A Worked Example</a></li>
<li class="chapter" data-level="5.4" data-path="categorical-variables.html"><a href="categorical-variables.html#endogenous-categorical-variables"><i class="fa fa-check"></i><b>5.4</b> Endogenous Categorical Variables</a></li>
<li class="chapter" data-level="5.5" data-path="categorical-variables.html"><a href="categorical-variables.html#references-3"><i class="fa fa-check"></i><b>5.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multigroup-analysis.html"><a href="multigroup-analysis.html"><i class="fa fa-check"></i><b>6</b> Multigroup Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="multigroup-analysis.html"><a href="multigroup-analysis.html#introduction-to-multigroup-analysis"><i class="fa fa-check"></i><b>6.1</b> Introduction to Multigroup Analysis</a></li>
<li class="chapter" data-level="6.2" data-path="multigroup-analysis.html"><a href="multigroup-analysis.html#multigroup-analysis-using-global-estimation"><i class="fa fa-check"></i><b>6.2</b> Multigroup Analysis using Global Estimation</a></li>
<li class="chapter" data-level="6.3" data-path="multigroup-analysis.html"><a href="multigroup-analysis.html#multigroup-analysis-using-local-estimation"><i class="fa fa-check"></i><b>6.3</b> Multigroup Analysis Using Local Estimation</a></li>
<li class="chapter" data-level="6.4" data-path="multigroup-analysis.html"><a href="multigroup-analysis.html#grace-jutila-1999-a-worked-example"><i class="fa fa-check"></i><b>6.4</b> Grace &amp; Jutila (1999): A Worked Example</a></li>
<li class="chapter" data-level="6.5" data-path="multigroup-analysis.html"><a href="multigroup-analysis.html#references-4"><i class="fa fa-check"></i><b>6.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html"><i class="fa fa-check"></i><b>7</b> Latent Variable Modeling</a><ul>
<li class="chapter" data-level="7.1" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html#introduction-to-latent-variable-modeling"><i class="fa fa-check"></i><b>7.1</b> Introduction to Latent Variable Modeling</a></li>
<li class="chapter" data-level="7.2" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html#application-of-latent-variables-to-path-models"><i class="fa fa-check"></i><b>7.2</b> Application of Latent Variables to Path Models</a></li>
<li class="chapter" data-level="7.3" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html#latent-variables-in-lavaan"><i class="fa fa-check"></i><b>7.3</b> Latent Variables in <em>lavaan</em></a></li>
<li class="chapter" data-level="7.4" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html#multi-indicator-latent-variables"><i class="fa fa-check"></i><b>7.4</b> Multi-indicator Latent Variables</a></li>
<li class="chapter" data-level="7.5" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html#confirmatory-factor-analysis"><i class="fa fa-check"></i><b>7.5</b> Confirmatory Factor Analysis</a></li>
<li class="chapter" data-level="7.6" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html#travis-grace-2010-an-example"><i class="fa fa-check"></i><b>7.6</b> Travis &amp; Grace (2010): An Example</a></li>
<li class="chapter" data-level="7.7" data-path="latent-variable-modeling.html"><a href="latent-variable-modeling.html#references-5"><i class="fa fa-check"></i><b>7.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="composite-variables.html"><a href="composite-variables.html"><i class="fa fa-check"></i><b>8</b> Composite Variables</a><ul>
<li class="chapter" data-level="8.1" data-path="composite-variables.html"><a href="composite-variables.html#what-is-a-composite-variable"><i class="fa fa-check"></i><b>8.1</b> What is a Composite Variable?</a></li>
<li class="chapter" data-level="8.2" data-path="composite-variables.html"><a href="composite-variables.html#constructing-a-composite-variable"><i class="fa fa-check"></i><b>8.2</b> Constructing a Composite Variable</a></li>
<li class="chapter" data-level="8.3" data-path="composite-variables.html"><a href="composite-variables.html#grace-keeley-revisited-a-worked-example"><i class="fa fa-check"></i><b>8.3</b> Grace &amp; Keeley Revisited: A Worked Example</a></li>
<li class="chapter" data-level="8.4" data-path="composite-variables.html"><a href="composite-variables.html#composites-in-piecewisesem"><i class="fa fa-check"></i><b>8.4</b> Composites in <em>piecewiseSEM</em></a></li>
<li class="chapter" data-level="8.5" data-path="composite-variables.html"><a href="composite-variables.html#references-6"><i class="fa fa-check"></i><b>8.5</b> References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Equation Modeling in R for Ecology and Evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorical-variables" class="section level1">
<h1><span class="header-section-number">5</span> Categorical Variables</h1>
<p>While SEM was initially derived to consider only continuous variables (and indeed most applications still do), it’s often the case–especially in ecology–that the observed variables are discrete. For example: binary (yes/no, failure/success, etc.), nominal (site 1, site 2), or ordinal levels (small &lt; medium &lt; large). Newer advances in modeling allow for the incorporation, either directly or in a more roundabout fashion, of categorical variables into SEM.</p>
<p>There are two way that categorical variables could be included: as exogenous (predictors) or endogenous (responses). We will deal with the simpler case of exogenous categorical variables first, as they pose not so much of a computational issue but a conceptual one.</p>
<div id="introduction-to-exogenous-categorical-variables" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction to Exogenous Categorical Variables</h2>
<p>Recall that a linear regression predicting y has the following standard form:</p>
<p><span class="math display">\[y = \alpha + \beta_{1}*x_{1} + \epsilon\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the intercept, <span class="math inline">\(\beta_{1}\)</span> is the slope of the effect of <span class="math inline">\(x\)</span> on y, and <span class="math inline">\(\epsilon\)</span> is the residual error.</p>
<p>When <span class="math inline">\(x\)</span> is continuous, the intercept <span class="math inline">\(\alpha\)</span> is intepreted as the value of y when <span class="math inline">\(x\)</span> = 0. All good.</p>
<p>For categorical factors, the intercept <span class="math inline">\(\alpha\)</span> has a different interpretation. Consider a value of <span class="math inline">\(x\)</span> with <span class="math inline">\(k\)</span> levels. Since the levels of <span class="math inline">\(x\)</span> are discrete and presumably can never assume a value of 0, <span class="math inline">\(\alpha\)</span> is instead the mean value of y at the ‘reference’ level of <span class="math inline">\(x\)</span>. (In R, the reference level is the first level alphabetically, although this can be reset manually.) The regression coefficients <span class="math inline">\(\beta_{k}\)</span> are therefore the effect of each other level <em>relative</em> to the reference level. So for <span class="math inline">\(k\)</span> levels, there are <span class="math inline">\(k - 1\)</span> coefficients estimated with the additional <span class="math inline">\(\alpha\)</span> term reflecting the <span class="math inline">\(k\)</span>th level.</p>
<p>Another way to think about this phenomenon is using so-called ‘dummy’ variables. Imagine each level was broken into a separate variable with a value of 0 or 1: a two-level factor with levels “a” and “b” would then become two factors “a” and “b” each with the levels 0 or 1. (In R, this would mean transposing rows as columns.)</p>
<p>Now imagine setting all the values of these dummy variables to 0 to estimate the intercept: this would imply the total absence of the factor, which is not a state. Another way of thinking about this is that the dummy variables are linearly dependent: if “a = 1” then by definition “b = 0” as the response variable cannot occupy the two states simultaneously. Hence the need to set one level as the reference, so that the effect of “a” can be interpreted relative to the absence of “b”, and also why you don’t recover as many coefficients as there are levels. I once heard it state that one level had to “fall on the sword” so that we can estimate the other levels.</p>
<p>This behavior presents a challenge for parameterizing path diagrams: there is not a single coefficient for the path from <span class="math inline">\(x\)</span> -&gt; <span class="math inline">\(y\)</span>, nor are there enough coefficients to populate a separate arrow for each level of <span class="math inline">\(x\)</span> (because one level must serve as the reference).</p>
<p>There are a few potential solutions:</p>
<ul>
<li><p>for binary variables, set the values as 0 or 1 and model as numeric, which would yield a single coefficient representing the expected change in <span class="math inline">\(y\)</span> as <span class="math inline">\(x\)</span> changes from state “0” to the other state “1.”</p></li>
<li><p>for ordinal variables, set the values depending on the order of the factor, e.g., small = 1 &lt; medium = 2 &lt; large = 3, and then model as numeric, which would also yield a single coefficient represented the expected change in <span class="math inline">\(x\)</span> as you climb the ordinal ladder from smallest, to medium, and so on.</p></li>
<li><p>create dummy variables for each level: this is procedurally the same as above (splitting levels into <span class="math inline">\(k\)</span> - 1 separate variables that have a state of or/1). The key here is not to create <span class="math inline">\(k\)</span> variables, to avoid the issue raised above about dependence among levels. This is the default behavior of <em>lavaan</em>.</p></li>
</ul>
<p>This approach becomes prohibitive with large number of categories or levels and can greatly increase model complexity. Moreover, each level is treated as an independent variable in the tests of directed separation, and thus will inflate the degrees of freedom in a piecewise application.</p>
<ul>
<li><p>for suspected interactions with categorical variables, a multigroup analysis is required. In this case, the same model is fit for each level of the factor, with potentially different coefficients (see the following chapter on Multigroup Modeling).</p></li>
<li><p>test for the effect of the categorical variable using ANOVA, but do not report a coefficient. This approach would indicate whether a factor is important (i.e., whether the levels significantly differ with respect to the response), but omits important information about which levels and the direction and magnitude of change. For example, does a significant treatment effect imply an increase or decrease in the response, and by how much? For this reason, such an approach is valid but not ideal.</p></li>
</ul>
<p>A alternate approach draws on this final point and involves testing and reporting the model-estimated or marginal means.</p>
</div>
<div id="exogenous-categorical-variables-as-marginal-means" class="section level2">
<h2><span class="header-section-number">5.2</span> Exogenous Categorical Variables as Marginal Means</h2>
<p>All models can be used for prediction. In multiple regression, the predicted values of one variable are often computed while holding the values of other variables at their mean. Marginal means are the averages of these predictions. In other words, they are the expected average value of one predictor given the other co-variables in the model.</p>
<p>For categorical variables, marginal means are particularly useful because they provide an estimated mean for each level of each factor.</p>
<p>Consider a simple example with a single response and two groups “a” and “b”:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="categorical-variables.html#cb213-1"></a><span class="kw">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb213-2"><a href="categorical-variables.html#cb213-2"></a></span>
<span id="cb213-3"><a href="categorical-variables.html#cb213-3"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y =</span> <span class="kw">runif</span>(<span class="dv">100</span>), <span class="dt">group =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</span>
<span id="cb213-4"><a href="categorical-variables.html#cb213-4"></a></span>
<span id="cb213-5"><a href="categorical-variables.html#cb213-5"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>group, dat)</span>
<span id="cb213-6"><a href="categorical-variables.html#cb213-6"></a></span>
<span id="cb213-7"><a href="categorical-variables.html#cb213-7"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ group, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.48473 -0.21466 -0.01238  0.19715  0.54995 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.44677    0.03871  11.541   &lt;2e-16 ***
## groupb       0.08551    0.05475   1.562    0.122    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2737 on 98 degrees of freedom
## Multiple R-squared:  0.02429,    Adjusted R-squared:  0.01433 
## F-statistic:  2.44 on 1 and 98 DF,  p-value: 0.1215</code></pre>
<p>Note that the summary output gives a simple coefficient, which is the effect of group “b” on y in the absence of group “a”. As we established above, the intercept is simply the average of y in group “a”:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="categorical-variables.html#cb215-1"></a><span class="kw">summary</span>(model)<span class="op">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.4467679</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="categorical-variables.html#cb217-1"></a><span class="kw">mean</span>(<span class="kw">subset</span>(dat, group <span class="op">==</span><span class="st"> &quot;a&quot;</span>)<span class="op">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.4467679</code></pre>
<p>The marginal means are the expected average value of y in group “a” AND group “b”.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="categorical-variables.html#cb219-1"></a><span class="kw">predict</span>(model, <span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="st">&quot;a&quot;</span>))</span></code></pre></div>
<pre><code>##         1 
## 0.4467679</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="categorical-variables.html#cb221-1"></a><span class="kw">predict</span>(model, <span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="st">&quot;b&quot;</span>))</span></code></pre></div>
<pre><code>##       1 
## 0.53228</code></pre>
<p>Because this is a simple linear regression, these values are simply the means of the two subsets of the data, because they are not controlling for any other covariates:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="categorical-variables.html#cb223-1"></a><span class="kw">mean</span>(<span class="kw">subset</span>(dat, group <span class="op">==</span><span class="st"> &quot;a&quot;</span>)<span class="op">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.4467679</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="categorical-variables.html#cb225-1"></a><span class="kw">mean</span>(<span class="kw">subset</span>(dat, group <span class="op">==</span><span class="st"> &quot;b&quot;</span>)<span class="op">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.53228</code></pre>
<p>Let’s see what happens we add a continuous covariate:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="categorical-variables.html#cb227-1"></a>dat<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)</span>
<span id="cb227-2"><a href="categorical-variables.html#cb227-2"></a></span>
<span id="cb227-3"><a href="categorical-variables.html#cb227-3"></a>model &lt;-<span class="st"> </span><span class="kw">update</span>(model, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>x)</span></code></pre></div>
<p>Here, the marginal mean must be evaluated while holding the covariate <span class="math inline">\(x\)</span> at its mean value:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="categorical-variables.html#cb228-1"></a><span class="kw">predict</span>(model, <span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">x =</span> <span class="kw">mean</span>(dat<span class="op">$</span>x)))</span></code></pre></div>
<pre><code>##         1 
## 0.4450597</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="categorical-variables.html#cb230-1"></a><span class="kw">mean</span>(<span class="kw">subset</span>(dat, group <span class="op">==</span><span class="st"> &quot;a&quot;</span>)<span class="op">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.4467679</code></pre>
<p>You’ll note that this value is now different than the mean of the subset of the data because, again, it controls for the effect of <span class="math inline">\(x\)</span> on <span class="math inline">\(y\)</span>.</p>
<p>This procedure gets increasingly complicated with both the number of factor levels and the number of covariates. The <em>emmeans</em> package provides an easy way to compute marginal means:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="categorical-variables.html#cb232-1"></a><span class="kw">library</span>(emmeans)</span>
<span id="cb232-2"><a href="categorical-variables.html#cb232-2"></a></span>
<span id="cb232-3"><a href="categorical-variables.html#cb232-3"></a><span class="kw">emmeans</span>(model, <span class="dt">specs =</span> <span class="st">&quot;group&quot;</span>) <span class="co"># where specs is the variable or list of variables whose means are to be estimated</span></span></code></pre></div>
<pre><code>##  group emmean     SE df lower.CL upper.CL
##  a      0.445 0.0389 97    0.368    0.522
##  b      0.534 0.0389 97    0.457    0.611
## 
## Confidence level used: 0.95</code></pre>
<p>You’ll note that the output value for group “a” gives the same as using the <code>predict</code> function above, but also returns the marginal mean for group “b” while also controlling for <span class="math inline">\(x\)</span>:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="categorical-variables.html#cb234-1"></a><span class="kw">predict</span>(model, <span class="kw">data.frame</span>(<span class="dt">group =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">x =</span> <span class="kw">mean</span>(dat<span class="op">$</span>x)))</span></code></pre></div>
<pre><code>##         1 
## 0.5339882</code></pre>
<p>and so is a handy wrapper for complex models.</p>
<p>The <code>emmeans</code> function goes onto to provide lower and upper confidence intervals, which provides an additional level of information, namely whether each mean differs significantly from zero. Coupled with ANOVA test for differences among categories, the marginal means provide key information that is otherwise lacking, namely whether and <em>how</em> the response value changes based on the factor level. It is import</p>
<p>The <em>emmeans</em> package provides additional functionality by conducting post-hoc tests of differences among the means of each factor level:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="categorical-variables.html#cb236-1"></a><span class="kw">emmeans</span>(model, <span class="kw">list</span>(pairwise <span class="op">~</span><span class="st"> </span>group))</span></code></pre></div>
<pre><code>## $`emmeans of group`
##  group emmean     SE df lower.CL upper.CL
##  a      0.445 0.0389 97    0.368    0.522
##  b      0.534 0.0389 97    0.457    0.611
## 
## Confidence level used: 0.95 
## 
## $`pairwise differences of group`
##  1     estimate     SE df t.ratio p.value
##  a - b  -0.0889 0.0552 97 -1.611  0.1105</code></pre>
<p>You’ll note a second output which is the pairwise contrast between the means of groups “a” and “b” with an associated significance test.</p>
<p>These pairwise Tukey tests provide the final level of information, which is whether the response in each level varies significantly from the other levels.</p>
<p>To adapt this to SEM, the <code>coefs</code> function in <em>piecewiseSEM</em> adopts a two-tiered approach by first computing the significance of the categorical variable using ANOVA, and then reports the marginal means and post-hoc tests:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="categorical-variables.html#cb238-1"></a><span class="kw">library</span>(piecewiseSEM)</span>
<span id="cb238-2"><a href="categorical-variables.html#cb238-2"></a></span>
<span id="cb238-3"><a href="categorical-variables.html#cb238-3"></a><span class="kw">coefs</span>(model)</span></code></pre></div>
<pre><code>##   Response Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate    
## 1        y         x   0.0567     0.093 97     0.6094  0.5437       0.0613    
## 2        y     group        -         -  1     2.5946  0.1105            -    
## 3        y group = a   0.4451    0.0389 97    11.4300  0.0000            - ***
## 4        y group = b    0.534    0.0389 97    13.7139  0.0000            - ***</code></pre>
<p>In this output, we retrieve the normal output for the continuous <span class="math inline">\(x\)</span> including a standardized effect size. The significance test from the ANOVA is reported in the row corresponding to the group effect, and below that are the marginal means for each level of the grouping factor. Note that there are no standardized estimates for either the ANOVA effect or the marginal means, because as we have established, these are not linear coefficients and therefore cannot be standardized as usual.</p>
<p>This solution provides a measure of whether the path between the exogenous categorical variable and the response is significant as well as parameters for each level in the form of the model-estimated marginal means.</p>
</div>
<div id="exogenous-categorical-variables-as-marginal-means-a-worked-example" class="section level2">
<h2><span class="header-section-number">5.3</span> Exogenous Categorical Variables as Marginal Means: A Worked Example</h2>
<p>Let’s consider an example from Bowen et al. (2017). In this study, the authors were interested in how different microbiomes of the salt marsh plant <em>Phragmites australis</em> drive ecosystem functioning, and ultimately the production of aboveground biomass. In this case, they considered three microbial communities: those from a native North American lineage, from Gulf Coast lineage, and an introduced lineage. There were additional genotypes within each community type, necessitating the application of random effects to account for intraspecific variation.</p>
<p>We will fit a simplified version of their full path diagram, focusing only on aboveground biomass (although they test the effect on belowground biomass in their study as well).</p>
<p><img src="https://raw.githubusercontent.com/jslefche/sem_book/master/img/categorical_variables_bowen_sem.png" /></p>
<p>In this case, the variable “<em>Phragmites</em> status” corresponds to the three community types and can’t be represented using a single coefficient. Thus, the marginal-means approach is ideal to elucidate the effect of each community type on both proximate and ultimate ecosystem properties while testing the overall significance of this path.</p>
<p>Let’s read in the data and construct the model:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="categorical-variables.html#cb240-1"></a>bowen &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/jslefche/sem_book/master/data/bowen.csv&quot;</span>)</span>
<span id="cb240-2"><a href="categorical-variables.html#cb240-2"></a></span>
<span id="cb240-3"><a href="categorical-variables.html#cb240-3"></a>bowen &lt;-<span class="st"> </span><span class="kw">na.omit</span>(bowen)</span>
<span id="cb240-4"><a href="categorical-variables.html#cb240-4"></a></span>
<span id="cb240-5"><a href="categorical-variables.html#cb240-5"></a><span class="kw">library</span>(nlme)</span>
<span id="cb240-6"><a href="categorical-variables.html#cb240-6"></a></span>
<span id="cb240-7"><a href="categorical-variables.html#cb240-7"></a>bowen_sem &lt;-<span class="st"> </span><span class="kw">psem</span>(</span>
<span id="cb240-8"><a href="categorical-variables.html#cb240-8"></a>  <span class="kw">lme</span>(observed_otus <span class="op">~</span><span class="st"> </span>status, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>Genotype, <span class="dt">data =</span> bowen, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>),</span>
<span id="cb240-9"><a href="categorical-variables.html#cb240-9"></a>  <span class="kw">lme</span>(RNA.DNA <span class="op">~</span><span class="st"> </span>status <span class="op">+</span><span class="st"> </span>observed_otus, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>Genotype, <span class="dt">data =</span> bowen, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>), </span>
<span id="cb240-10"><a href="categorical-variables.html#cb240-10"></a>  <span class="kw">lme</span>(below.C <span class="op">~</span><span class="st"> </span>observed_otus <span class="op">+</span><span class="st"> </span>status, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>Genotype, <span class="dt">data =</span> bowen, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>), </span>
<span id="cb240-11"><a href="categorical-variables.html#cb240-11"></a>  <span class="kw">lme</span>(abovebiomass_g <span class="op">~</span><span class="st"> </span>RNA.DNA <span class="op">+</span><span class="st"> </span>observed_otus <span class="op">+</span><span class="st"> </span>belowCN <span class="op">+</span><span class="st"> </span>status, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>Genotype, <span class="dt">data =</span> bowen, <span class="dt">method =</span> <span class="st">&quot;ML&quot;</span>),</span>
<span id="cb240-12"><a href="categorical-variables.html#cb240-12"></a>  <span class="dt">data =</span> bowen</span>
<span id="cb240-13"><a href="categorical-variables.html#cb240-13"></a>)</span></code></pre></div>
<p>And let’s retrieve the output:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="categorical-variables.html#cb241-1"></a><span class="kw">summary</span>(bowen_sem, <span class="dt">.progressBar =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: Categorical or non-linear variables detected. Please refer to
## documentation for interpretation of Estimates!</code></pre>
<pre><code>## 
## Structural Equation Model of bowen_sem 
## 
## Call:
##   observed_otus ~ status
##   RNA.DNA ~ status + observed_otus
##   below.C ~ observed_otus + status
##   abovebiomass_g ~ RNA.DNA + observed_otus + belowCN + status
## 
##     AIC
##  1110.030
## 
## ---
## Tests of directed separation:
## 
##                   Independ.Claim Test.Type DF Crit.Value P.Value   
##    observed_otus ~ belowCN + ...      coef 57     1.4405  0.1552   
##          RNA.DNA ~ belowCN + ...      coef 56     1.3740  0.1749   
##          below.C ~ belowCN + ...      coef 56     2.7225  0.0086 **
##          below.C ~ RNA.DNA + ...      coef 56    -0.1762  0.8607   
##   abovebiomass_g ~ below.C + ...      coef 54    -0.4540  0.6516   
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 11.484 with P-value = 0.043 and on 5 degrees of freedom
## Fisher&#39;s C = 17.877 with P-value = 0.057 and on 10 degrees of freedom
## 
## ---
## Coefficients:
## 
##         Response           Predictor  Estimate Std.Error DF Crit.Value P.Value
##    observed_otus              status         -         -  2     5.9589  0.0508
##    observed_otus     status = native 2258.6564  105.8178 12    21.3448  0.0000
##    observed_otus status = introduced   2535.07  131.2216 14    19.3190  0.0000
##    observed_otus   status = invasive 2541.4984   56.6887 12    44.8326  0.0000
##          RNA.DNA       observed_otus         0         0 57     2.1583  0.0351
##          RNA.DNA              status         -         -  2     9.3480  0.0093
##          RNA.DNA   status = invasive    0.7112    0.0118 12    60.4511  0.0000
##          RNA.DNA status = introduced    0.7305    0.0264 14    27.6880  0.0000
##          RNA.DNA     status = native    0.7844    0.0216 12    36.2988  0.0000
##          below.C       observed_otus     9e-04     3e-04 57     2.6546  0.0103
##          below.C              status         -         -  2    17.1995  0.0002
##          below.C status = introduced   42.6366    0.3673 14   116.0774  0.0000
##          below.C   status = invasive   43.4004    0.1594 12   272.2299  0.0000
##          below.C     status = native   44.4975    0.3056 12   145.6071  0.0000
##   abovebiomass_g             RNA.DNA   -1.8517    1.8893 55    -0.9801  0.3313
##   abovebiomass_g       observed_otus    -2e-04     2e-04 55    -0.7521  0.4552
##   abovebiomass_g             belowCN     0.005    0.0041 55     1.2026  0.2343
##   abovebiomass_g              status         -         -  2    12.9519  0.0015
##   abovebiomass_g     status = native    1.7489    0.2206 12     7.9272  0.0000
##   abovebiomass_g   status = invasive    1.8807    0.1041 12    18.0629  0.0000
##   abovebiomass_g status = introduced    2.7024     0.232 14    11.6457  0.0000
##   Std.Estimate    
##              -    
##              - ***
##              - ***
##              - ***
##          0.135   *
##              -  **
##              - ***
##              - ***
##              - ***
##         0.2913   *
##              - ***
##              - ***
##              - ***
##              - ***
##        -0.1428    
##        -0.0905    
##         0.1356    
##              -  **
##              - ***
##              - ***
##              - ***
## 
##   Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05
## 
## ---
## Individual R-squared:
## 
##         Response method Marginal Conditional
##    observed_otus   none     0.10        0.19
##          RNA.DNA   none     0.31        0.81
##          below.C   none     0.26        0.32
##   abovebiomass_g   none     0.22        0.28</code></pre>
<p>In this case, it appears that the model fits the data well enough based on the Fisher’s <em>C</em> statistic (<em>P</em> = 0.057), which is what the original authors used. Note that the likelihood-based <span class="math inline">\(\chi^2\)</span> statistic actually implies poor fit (<em>P</em> = 0.043). In this case, examining the d-sep tests suggests the inclusion of the path from <span class="math inline">\(belowCN\)</span> to <span class="math inline">\(below.C\)</span> might improve the fit. However, we are applying a tool that was not available to the original authors, so we will proceed as they did and assume adequate fit.</p>
<p>The linkage between microbial community type (<span class="math inline">\(status\)</span>) and richness (<span class="math inline">\(observed_otus\)</span>) is non-significant, but the other paths are significant. Examination of the marginal means indicates microbial activity (<span class="math inline">\(RNA.DNA\)</span>) and belowground carbon (<span class="math inline">\(below.C\)</span>) are generally highest in <em>Phragmites</em> with native microbial communities based on the post-hoc tests. However, none of these properties appear to influence the ultimate production of biomass (<span class="math inline">\(abovebiomass_g\)</span>). Rather, that property appears to be entirely controlled by the plant microbiome type (<span class="math inline">\(status\)</span>): those with the introduced microbial community have significantly higher aboveground biomass based on their marginal mean after controlling for microbial activity and soil nutrients.</p>
<p>Thus, despite a multi-level categorical predictor (<span class="math inline">\(status\)</span>), the two-step procedure of ANOVA and calculation of marginal means allows for a more mechanistic understanding of the drivers of plant biomass in this species.</p>
</div>
<div id="endogenous-categorical-variables" class="section level2">
<h2><span class="header-section-number">5.4</span> Endogenous Categorical Variables</h2>
<p>Endogenous categorical variables are far trickier, and at the moment, are not implemented in <em>piecewiseSEM</em>.</p>
<p>In the case of endogenous categorical variables in a piecewise framework, there are really only two solutions:</p>
<ul>
<li><p>for binary variables, set the values as 0 or 1 and model as numeric, which would yield a single coefficient.</p></li>
<li><p>for ordinal variables, set the values depending on the order of the factor, e.g., small = 1 &lt; medium = 2 &lt; large = 3, and then model as numeric, which would yield a single coefficient.</p></li>
</ul>
<p>Nominal variables (i.e., levels are not ordered) could be modeled using multinomial regression, although this method would have to be executed by hand. An alternative is to use the factor levels to construct a <em>composite variable</em>, the subject of a later chapter. <em>lavaan</em> provides a robust alternative in the form of confirmatory factor analysis (see <a href="http://lavaan.ugent.be/tutorial/cat.html">http://lavaan.ugent.be/tutorial/cat.html</a>). In <em>piecewiseSEM</em>, composites must be constructed by hand, although this procedure is not hugely prohibitive.</p>
</div>
<div id="references-3" class="section level2">
<h2><span class="header-section-number">5.5</span> References</h2>
<p>Bowen, J. L., Kearns, P. J., Byrnes, J. E., Wigginton, S., Allen, W. J., Greenwood, M., … &amp; Meyerson, L. A. (2017). Lineage overwhelms environmental conditions in determining rhizosphere bacterial community structure in a cosmopolitan invasive plant. Nature communications, 8(1), 433.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="coefficients.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multigroup-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
